---
name: knowledge-query
description: |
  å€‹äººçŸ¥è­˜åº«æŸ¥è©¢èˆ‡åŒ¯å…¥ã€‚æŸ¥è©¢ localhost:3000 çŸ¥è­˜åº«ç­†è¨˜ï¼Œæˆ–å°‡ç ”ç©¶æˆæœåŒ¯å…¥ã€‚
  Use when: çŸ¥è­˜åº«ã€ç­†è¨˜ã€æœå°‹ç­†è¨˜ã€åŒ¯å…¥ã€ç ”ç©¶æˆæœã€çŸ¥è­˜æŸ¥è©¢ã€‚
allowed-tools: Bash, Read, Write
cache-ttl: 60min
---

# çŸ¥è­˜åº«æŸ¥è©¢èˆ‡åŒ¯å…¥

æŸ¥è©¢å€‹äººçŸ¥è­˜åº«å–å¾—ç­†è¨˜å…§å®¹ï¼Œæˆ–å°‡ç ”ç©¶æˆæœåŒ¯å…¥çŸ¥è­˜åº«ã€‚

## å‰ææ¢ä»¶

çŸ¥è­˜åº«æœå‹™å¿…é ˆåœ¨æœ¬æ©ŸåŸ·è¡Œä¸­ï¼š`http://localhost:3000`

## æ¬„ä½åˆ†å·¥ï¼ˆé‡è¦ï¼‰

çŸ¥è­˜åº«æœ‰å…©å€‹å…§å®¹æ¬„ä½ï¼Œç”¨é€”ä¸åŒï¼š

| æ¬„ä½ | æ ¼å¼ | ç”¨é€” | åŒ¯å…¥æ™‚æ€éº¼å¡« |
|------|------|------|-------------|
| `contentText` | Markdown / ç´”æ–‡å­— | **å…¨æ–‡æœå°‹ç´¢å¼•**ï¼ˆFTS5 + å‘é‡æœå°‹ï¼‰ | **å¿…å¡«**ï¼šæ”¾ä½ çš„ Markdown å…§å®¹ |
| `content` | Tiptap JSON | **å‰ç«¯ç·¨è¼¯å™¨æ¸²æŸ“** | **ä¸å¡«**ï¼šå¾Œç«¯å¾ contentText è‡ªå‹•ç”Ÿæˆ |

**è¦å‰‡ï¼šåŒ¯å…¥æ™‚åªéœ€å¡« `contentText`ï¼Œ`content` ç”±å¾Œç«¯è‡ªå‹•è½‰æ›ã€‚**

---

## æŸ¥è©¢ç­†è¨˜

### æ­¥é©Ÿ 1ï¼šç¢ºèªæœå‹™æ˜¯å¦é‹è¡Œ

```bash
curl -s "http://localhost:3000/api/health"
```

è‹¥å›å‚³éŒ¯èª¤æˆ–ç„¡å›æ‡‰ï¼Œè·³éçŸ¥è­˜åº«å€å¡Šä¸¦åœ¨æ‘˜è¦ä¸­æ¨™è¨»ã€ŒçŸ¥è­˜åº«æœå‹™æœªå•Ÿå‹•ã€ã€‚

### æ­¥é©Ÿ 2ï¼šå–å¾—æœ€è¿‘çš„ç­†è¨˜

```bash
curl -s "http://localhost:3000/api/notes?limit=20" | python -c "
import sys, json
data = json.load(sys.stdin)
for n in data.get('notes', [])[:5]:
    print(f\"- {n['title']}\")
"
```

æˆ–ä½¿ç”¨æ··åˆæœç´¢å–å¾—æ¯æ—¥ç›¸é—œå…§å®¹ï¼š

```bash
curl -s -X POST "http://localhost:3000/api/search/hybrid" \
  -H "Content-Type: application/json" \
  -d "{\"query\": \"ä»Šæ—¥å­¸ç¿’ ç­†è¨˜ é‡é»\", \"topK\": 3}"
```

### æ­¥é©Ÿ 3ï¼šç”¢å‡ºæ‘˜è¦

å¾æŸ¥è©¢çµæœä¸­æŒ‘é¸ 1-3 å‰‡æœ€ç›¸é—œçš„ç­†è¨˜ï¼Œæ ¼å¼ï¼š

```
ğŸ“ çŸ¥è­˜åº«å›é¡§
- [ç­†è¨˜æ¨™é¡Œ]ï¼šä¸€å¥è©±æ‘˜è¦
```

---

## åŒ¯å…¥ç­†è¨˜

å°‡ç ”ç©¶æˆæœæˆ–æ•´ç†å…§å®¹åŒ¯å…¥çŸ¥è­˜åº«ã€‚

> **Windows æ³¨æ„**ï¼šPOST çš„ inline JSON åœ¨ Windows Bash æœƒå¤±æ•—ï¼Œå¿…é ˆç”¨ JSON æª”æ¡ˆæ–¹å¼ç™¼é€ã€‚

### åŒ¯å…¥æ­¥é©Ÿï¼ˆä½¿ç”¨ /api/importï¼‰

```bash
# æ­¥é©Ÿ 1ï¼šç”¨ Write å·¥å…·å»ºç«‹ JSON æª”æ¡ˆï¼ˆimport_note.jsonï¼‰
#
# âš ï¸ é‡é»ï¼šå…§å®¹æ”¾åœ¨ contentTextï¼Œcontent ä¸è¦å¡«
#
# {
#   "notes": [
#     {
#       "title": "ç­†è¨˜æ¨™é¡Œ",
#       "contentText": "ä½ çš„ Markdown å…§å®¹\n\n## å­æ¨™é¡Œ\n\n- åˆ—è¡¨é …\n- **ç²—é«”æ–‡å­—**",
#       "tags": ["æ¨™ç±¤1", "æ¨™ç±¤2"],
#       "source": "import"
#     }
#   ],
#   "autoSync": true
# }

# æ­¥é©Ÿ 2ï¼šç”¨ curl ç™¼é€
curl -s -X POST "http://localhost:3000/api/import" \
  -H "Content-Type: application/json; charset=utf-8" \
  -d @import_note.json

# æ­¥é©Ÿ 3ï¼šåˆªé™¤æš«å­˜æª”
rm import_note.json
```

### contentText æ”¯æ´çš„ Markdown èªæ³•

å¾Œç«¯æœƒè‡ªå‹•å°‡ä»¥ä¸‹èªæ³•è½‰ç‚º Tiptap JSONï¼š

- æ¨™é¡Œï¼ˆ# ## ###ï¼‰
- æ®µè½ï¼ˆç©ºè¡Œåˆ†éš”ï¼‰
- ç„¡åºåˆ—è¡¨ï¼ˆ- æˆ– *ï¼‰
- æœ‰åºåˆ—è¡¨ï¼ˆ1. 2. 3.ï¼‰
- ç¨‹å¼ç¢¼å€å¡Šï¼ˆ```ï¼‰
- å¼•ç”¨å€å¡Šï¼ˆ>ï¼‰
- åˆ†éš”ç·šï¼ˆ---ï¼‰
- **ç²—é«”**ï¼ˆ\*\*text\*\*ï¼‰
- *æ–œé«”*ï¼ˆ\*text\*ï¼‰
- è¡Œå…§ç¨‹å¼ç¢¼ï¼ˆ\`code\`ï¼‰
- é€£çµï¼ˆ[text](url)ï¼‰

### æ¬„ä½èªªæ˜

| æ¬„ä½ | å¿…å¡« | èªªæ˜ |
|------|------|------|
| `title` | æ˜¯ | ç­†è¨˜æ¨™é¡Œï¼ˆæœ€é•· 200 å­—å…ƒï¼‰ |
| `contentText` | æ˜¯ | Markdown æˆ–ç´”æ–‡å­—å…§å®¹ï¼ˆå¾Œç«¯è‡ªå‹•è½‰ç‚º Tiptap JSON å­˜å…¥ contentï¼‰ |
| `tags` | å¦ | æ¨™ç±¤é™£åˆ—ï¼Œä¾¿æ–¼åˆ†é¡æœå°‹ |
| `source` | å¦ | åƒ…æ¥å—ï¼š`manual`ã€`web`ã€`import`ï¼ˆé è¨­ `import`ï¼‰ |

> **ç¦æ­¢**ï¼šä¸è¦è‡ªå·±å¡« `content` æ¬„ä½ã€‚è®“å¾Œç«¯å¾ `contentText` è‡ªå‹•ç”Ÿæˆ Tiptap JSONã€‚

### æ‰¹é‡åŒ¯å…¥ï¼ˆå¤šç­†ï¼‰

ä¸€æ¬¡æœ€å¤šåŒ¯å…¥ 100 ç­†ï¼š

```bash
# {
#   "notes": [
#     { "title": "ç­†è¨˜1", "contentText": "å…§å®¹1", "tags": ["tag1"] },
#     { "title": "ç­†è¨˜2", "contentText": "å…§å®¹2", "tags": ["tag2"] }
#   ],
#   "autoSync": true
# }
```

### å›æ‡‰æ ¼å¼

```json
{
  "message": "Imported 1 notes, 0 failed",
  "result": {
    "success": true,
    "imported": 1,
    "failed": 0,
    "errors": [],
    "noteIds": ["uuid"]
  }
}
```

## æ³¨æ„äº‹é …

- å¦‚æœçŸ¥è­˜åº«æœå‹™æœªå•Ÿå‹•ï¼Œä¸è¦å ±éŒ¯ï¼Œåªéœ€åœ¨æ‘˜è¦ä¸­çœç•¥æ­¤å€å¡Š
- æŸ¥è©¢æ™‚ä¸éœ€è¦å–å¾—å®Œæ•´ç­†è¨˜å…§å®¹ï¼Œæ¨™é¡Œåˆ—è¡¨å³å¯
- åŒ¯å…¥å‰å…ˆç¢ºèªæœå‹™ health check é€šé
- **åŒ¯å…¥å…§å®¹æ”¾ `contentText`ï¼Œä¸è¦å¡« `content`**
- ä¸è¦æ‰‹å‹•å»ºæ§‹ Tiptap JSON
